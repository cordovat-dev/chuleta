# EN ~/.config/chu

sed -E -i.bak 's/NUM_DAYS_OLD/NUM_DAYS_OLD_DB_WRN/g' chu.conf

# EN ~/.cache/chu

sqlite3 chuletas.db
drop view v_old_db_msg;
CREATE VIEW v_old_db_msg as
select
        'Database is '||cast(d.age as int)||' days old. Please run chu --update .' msg
from
        (
                        select
                                (julianday(CURRENT_TIMESTAMP) - julianday(value)) >=
                                cast((select value from settings where key='NUM_DAYS_OLD_DB_WRN') as int) old,
                                (julianday(CURRENT_TIMESTAMP) - julianday(value)) age
                        from
                                settings
                        where
                                key = 'LAST_UPDATED'
        ) d
        join (
                select 1 old
        ) m on (d.old = m.old);
insert into settings values ('NUM_DAYS_OLD_DB_WRN',8);
delete from settings where key = 'NUM_DAYS_OLD';
.quit
